<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <link rel="stylesheet" href="{{document.meta.get_root_path_prefix()}}/_static/global.css" />
  <link rel="stylesheet" href="{{document.meta.get_root_path_prefix()}}/_static/layout-main-with-toc.css" />
  <link rel="stylesheet" href="{{document.meta.get_root_path_prefix()}}/_static/single_document_table.css" />
  <script type="text/javascript" src="{{document.meta.get_root_path_prefix()}}/_static/toc.js"></script>
  <title>{{document.name}} - Table</title>
</head>

<body>

  {%- set document_iterator = traceability_index.get_document_iterator(document) -%}

  <div id="toc_layout" class="layout-with-toc">

  <aside class="toc">
    {% include "_shared/table_of_contents.jinja.html" %}
  </aside>

  <main class="content">
    <h1 class="document-title">{{document.name}} <span class="document-view-type">Table</span></h1>

    {%- if traceability_index.has_tags(document) -%}
      <div id="tags-outline">
      {%- for tag in traceability_index.get_tags(document) %}
        <span class="tag">
          {{ tag[0] }} x {{ tag[1] }}
        </span>
      {%- endfor %}
      </div>
    {%- endif %}

    <table class="view-table" id="sections-and-requirements">
    {%- for free_text in document.free_texts -%}
       <tr class="view-table_text">
         <td colspan="4">
           {{ renderer.render_free_text(free_text) }}
         </td>
       </tr>
    {%- endfor -%}
    {%- for section_or_requirement in document_iterator.all_content() %}
        {%- if section_or_requirement.is_composite_requirement %}
          <tr class="view-table_section-title" id="{{ string_to_anchor_id(section_or_requirement.title) }}">
            <td colspan="4">
              {%- set section = section_or_requirement %}

              <h{{ section.ng_level }} class="section-title" data-level="{{ section.export_title }}">
                {{ section.title }}
              </h{{ section.ng_level }}>

            </td>
          </tr>
          {%- if not loop.last -%}
            {%- if not loop.nextitem.is_section -%}
            <tr class="view-table_requirement-headers">
              {% include "single_document_table/table-fields.jinja.html" %}
            </tr>
            {%- endif -%}
          {%- endif -%}
          <tr class="view-table_requirement" id="{{ string_to_anchor_id(section_or_requirement.title) }}">
            {%- set requirement = section_or_requirement %}
            {% include "single_document_table/requirement.jinja.html" %}
          </tr>
        {%- elif section_or_requirement.is_requirement %}
          <tr class="view-table_requirement" id="{{ string_to_anchor_id(section_or_requirement.title) }}">
            {%- set requirement = section_or_requirement %}
            {% include "single_document_table/requirement.jinja.html" %}
          </tr>
        {%- elif section_or_requirement.is_section %}
          <tr class="view-table_section-title" id="{{ string_to_anchor_id(section_or_requirement.title) }}">
            <td colspan="4">
              {%- set section = section_or_requirement %}
              <h{{ section.ng_level }} class="section-title" data-level="{{ section.export_title }}">
                {{ section.title }}
              </h{{ section.ng_level }}>
            </td>
          </tr>

          {%- for free_text in section_or_requirement.free_texts -%}
             <tr class="view-table_text">
               <td colspan="4">
                 {{ renderer.render_free_text(free_text) }}
               </td>
             </tr>
          {%- endfor %}
        {%- endif %}
    {%- endfor %}
    </table>

  </main>

  </div>
</body>
