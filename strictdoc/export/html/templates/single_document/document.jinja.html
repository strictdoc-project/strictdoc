<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <link rel="stylesheet" href="{{document.meta.get_root_path_prefix()}}/_static/global.css" />
  <link rel="stylesheet" href="{{document.meta.get_root_path_prefix()}}/_static/layout-main-with-toc.css" />
  <link rel="stylesheet" href="{{document.meta.get_root_path_prefix()}}/_static/single_document.css" />
  <script type="text/javascript" src="{{document.meta.get_root_path_prefix()}}/_static/toc.js"></script>
  <title>{{document.name}} - Traceability</title>
</head>

<body>

{%- set document_iterator = traceability_index.get_document_iterator(document) -%}

<div id="toc_layout" class="layout-with-toc">

  <aside class="toc">
    {% include "_shared/table_of_contents.jinja.html" %}
  </aside>

<main class="content">
  <h1 class="document-title">{{document.name}}</h1>

{%- for section_or_requirement in document_iterator.all_content() %}
  {%- if section_or_requirement.is_requirement %}
    {%- set requirement = section_or_requirement %}
    {% include "single_document/requirement.jinja.html" %}
  {%- elif section_or_requirement.is_section %}
    <div class="section">
      {%- set section = section_or_requirement %}
      <span id="{{ string_to_anchor_id(section_or_requirement.title) }}"></span>

      <h{{ section.ng_level }} class="section-title" data-level="{{ section.export_title }}">
        {{ section.title }}
      </h{{ section.ng_level }}>
  {%- elif section_or_requirement.is_free_text -%}
    {%- set freetext = section_or_requirement -%}
    <div class="free_text">
    {{ renderer.render_free_text(freetext) }}
    </div>
    {%- if freetext.ng_level > 1 -%}
      {%- if loop.last or not loop.nextitem.is_free_text -%}
        </div>  <!-- .section -->
      {%- endif %}
    {%- endif %}
  {%- endif %}
{%- endfor %}

</main>

</div>

</body>
